<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PathLaboratory-35</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .alert {
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            display: none;
        }
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 400px;
            position: relative;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 10px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .modal .form-group {
            margin-bottom: 15px;
        }

        .modal input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        .modal .submit-button {
            width: 100%;
            margin-top: 10px;
        }

        .modal .alert {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 4px;
            display: none;
        }

        .modal .alert.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .modal .alert.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">KWM<span>Charitable Lab</span></div>
            <button class="mobile-menu-btn" aria-label="Toggle mobile menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#facilities">Facilities</a></li>
                <li><a href="#team">Team</a></li>
                <li><a href="#contact">Book Test</a></li>
                <li><a href="#" class="login-btn" onclick="openLoginModal(event)">Admin Login</a></li>
            </ul>
        </nav>
    </header>

    <section id="home" class="hero">
        <div class="hero-content">
            <h1>Manav Kalyaan Parisar</h1>
            <p>Kailashwanti Memorial Charitable Laboratory</p>
            <a href="#contact" class="cta-button">Book a Test</a>
        </div>
    </section>

    <section id="services" class="services">
        <h2>Our Services</h2>
        <div class="services-grid">
            <div class="service-card">
                <img src="images/blood-test.jpg" alt="Blood Testing" class="service-img">
                <h3>Blood Testing</h3>
                <p>Comprehensive blood analysis including CBC, lipid profile, diabetes screening, and more</p>
            </div>
            <div class="service-card">
                <img src="images/histopathology.jpg" alt="Histopathology" class="service-img">
                <h3>Histopathology</h3>
                <p>Expert tissue examination and analysis for accurate diagnosis</p>
            </div>
            <div class="service-card">
                <img src="images/microbiology.jpg" alt="Microbiology" class="service-img">
                <h3>Microbiology</h3>
                <p>Culture studies and antibiotic sensitivity testing</p>
            </div>
        </div>
    </section>

    <section id="facilities" class="facilities">
        <h2>Our Facilities</h2>
        <div class="facilities-grid">
            <div class="facility">
                <img src="images/lab-facility.jpg" alt="Automated Analyzers" class="facility-img">
                <h3>Advanced Analyzers</h3>
                <p>State-of-the-art automated testing equipment for precise results</p>
            </div>
            <div class="facility">
                <img src="images/collection-center.jpg" alt="Collection Center" class="facility-img">
                <h3>Collection Centers</h3>
                <p>Comfortable sample collection facilities with trained phlebotomists</p>
            </div>
            <div class="facility">
                <img src="images/lab-facility.jpg" alt="Laboratory Facility" class="facility-img">
                <h3>Modern Laboratory</h3>
                <p>NABL accredited laboratory with latest technology</p>
            </div>
        </div>
    </section>

    <section id="gallery" class="gallery">
        <h2>Laboratory Gallery</h2>
        <div class="gallery-grid">
            <div class="gallery-item">
                <img src="images/blood-test.jpg" alt="Blood Analysis" class="gallery-img">
                <div class="gallery-overlay">
                    <p>Blood Analysis</p>
                </div>
            </div>
            <div class="gallery-item">
                <img src="images/pathology.jpg" alt="Pathology Lab" class="gallery-img">
                <div class="gallery-overlay">
                    <p>Pathology Testing</p>
                </div>
            </div>
            <div class="gallery-item">
                <img src="images/microscopy.jpg" alt="Microscopy" class="gallery-img">
                <div class="gallery-overlay">
                    <p>Microscopic Analysis</p>
                </div>
            </div>
            <div class="gallery-item">
                <img src="images/report-analysis.jpg" alt="Report Analysis" class="gallery-img">
                <div class="gallery-overlay">
                    <p>Report Analysis</p>
                </div>
            </div>
        </div>
    </section>

    <section id="team" class="team">
        <h2>Our Expert Team</h2>
        <div class="team-grid">
            <div class="team-member">
                <img src="images/pathologist1.jpg" alt="Dr. Sarah Johnson">
                <h3>Dr. Sarah Johnson</h3>
                <p>Chief Pathologist</p>
            </div>
            <div class="team-member">
                <img src="images/pathologist2.jpg" alt="Dr. Michael Chen">
                <h3>Dr. Michael Chen</h3>
                <p>Senior Pathologist</p>
            </div>
            <div class="team-member">
                <img src="images/technologist.jpg" alt="Emily Brown">
                <h3>Emily Brown</h3>
                <p>Lab Technologist</p>
            </div>
        </div>
    </section>

    <section id="contact" class="contact">
        <h2>Book a Test</h2>
        <div class="contact-container">
            <div id="alertBox" class="alert"></div>
            <form class="contact-form" id="bookingForm">
                <input type="text" name="name" placeholder="Your Name" required>
                <input type="email" name="email" placeholder="Your Email" required>
                <input type="tel" name="phone" placeholder="Phone Number" required>
                <select name="testType" required>
                    <option value="">Select Test Type</option>
                    <option value="blood">Blood Test</option>
                    <option value="urine">Urine Analysis</option>
                    <option value="covid">COVID-19 Test</option>
                    <option value="diabetes">Diabetes Screening</option>
                </select>
                <input type="date" name="preferredDate" required>
                <textarea name="message" placeholder="Additional Message (Optional)"></textarea>
                <button type="submit" class="submit-button" id="submitBtn">Book Appointment</button>
            </form>
        </div>
    </section>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLoginModal()">&times;</span>
            <h2>Admin Login</h2>
            <div id="loginAlert" class="alert"></div>
            <form id="adminLoginForm" onsubmit="handleAdminLogin(event)">
                <div class="form-group">
                    <input type="text" id="username" name="username" placeholder="Username" required>
                </div>
                <div class="form-group">
                    <input type="password" id="password" name="password" placeholder="Password" required>
                </div>
                <button type="submit" class="submit-button">Login</button>
            </form>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Manav Kalyan Parisar</h3>
                <p>Your trusted partner in diagnostic healthcare</p>
            </div>
            <div class="footer-section">
                <h3>Contact Info</h3>
                <p>Email: kwmcharitable@gmail.com</p>
                <p>Contact: +91-78148 03584</p>
                <p>Address: Manav Kalyan Parisar <br/> Ram Raksheshwar Temple, Dharamshala<br/> Sector 35-C, Chandigarh</p>
            </div>
            <div class="footer-section">
                <h3>Working Hours</h3>
                <p>Monday - Saturday: 8:00 AM - 5:00 PM</p>
                <p>Sunday: Close</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 PathLab. All rights reserved.</p>
        </div>
    </footer>
    <script>
        // Mobile menu functionality
        document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
            document.querySelector('nav ul').classList.toggle('active');
        });

        // Form submission
        const form = document.getElementById('bookingForm');
        const submitBtn = document.getElementById('submitBtn');
        const alertBox = document.getElementById('alertBox');

        function showAlert(message, isError = false) {
            alertBox.textContent = message;
            alertBox.className = `alert ${isError ? 'alert-error' : 'alert-success'}`;
            alertBox.style.display = 'block';
            setTimeout(() => {
                alertBox.style.display = 'none';
            }, 5000);
        }

        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            try {
                const formData = new FormData(this);
                const data = Object.fromEntries(formData.entries());
                
                const response = await fetch('http://localhost:5000/api/book', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showAlert(result.message);
                    this.reset();
                } else {
                    showAlert(result.error || 'Error submitting form', true);
                }
            } catch (error) {
                showAlert('Error connecting to server. Please try again later.', true);
                console.error('Error:', error);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Book Appointment';
            }
        });

        // Admin Login Modal Functions
        function openLoginModal(event) {
            event.preventDefault();
            document.getElementById('loginModal').style.display = 'block';
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('adminLoginForm').reset();
            document.getElementById('loginAlert').style.display = 'none';
        }

        function showLoginAlert(message, isError = false) {
            const alert = document.getElementById('loginAlert');
            alert.textContent = message;
            alert.className = `alert ${isError ? 'error' : 'success'}`;
            alert.style.display = 'block';
            
            if (!isError) {
                setTimeout(() => {
                    closeLoginModal();
                    window.location.href = '/admin';
                }, 1000);
            }
        }

        async function handleAdminLogin(event) {
            event.preventDefault();
            const form = event.target;
            const submitBtn = form.querySelector('button[type="submit"]');
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;

            // Basic validation
            if (!username || !password) {
                showLoginAlert('Please enter both username and password', true);
                return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Logging in...';

            try {
                const response = await fetch('/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showLoginAlert('Login successful! Redirecting to dashboard...', false);
                    setTimeout(() => {
                        window.location.href = '/admin';
                    }, 1000);
                } else {
                    // Handle specific error cases
                    if (response.status === 401) {
                        showLoginAlert('Invalid username or password', true);
                    } else if (response.status === 400) {
                        showLoginAlert(data.error || 'Invalid request', true);
                    } else {
                        showLoginAlert('Server error. Please try again later.', true);
                    }
                }
            } catch (error) {
                console.error('Login error:', error);
                showLoginAlert('Unable to connect to server. Please check your internet connection and try again.', true);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Login';
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('loginModal');
            if (event.target === modal) {
                closeLoginModal();
            }
        }
    </script>
</body>
</html>
